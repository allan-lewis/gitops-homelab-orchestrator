---
# L3 â€” Arch convergence (dry-run friendly)
- name: Arch DevOps Host Convergence
  hosts: arch_devops
  gather_facts: true
  become: true

  roles:
    - { role: arch_base,       tags: ["arch_base"] }
    - { role: arch_hardening,  tags: ["arch_hardening"] }
    - { role: arch_services,   tags: ["arch_services"] }
    - { role: arch_monitoring, tags: ["arch_monitoring"] }
    - { role: arch_devops,     tags: ["arch_devops"] }
    # Optional desktop layer; toggle via group_vars (default false)
    - { role: arch_aur,        when: arch_aur_enabled | default(false), tags: ["arch_aur"] }
    - { role: arch_desktop,    when: arch_desktop_enabled | default(false), tags: ["arch_desktop"] }
